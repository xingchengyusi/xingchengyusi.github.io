<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"localhost","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Generative Deep LearningIntroduction to Generative Adversarial Networks (GANs) (对抗生成网络)Combined by a forger network and an expert network.  Generator network Input: random vector (a random point at a">
<meta property="og:type" content="article">
<meta property="og:title" content="Generative Deep Learning">
<meta property="og:url" content="http://localhost:4000/en/computer/generative-deep-learning.html">
<meta property="og:site_name" content="XCYS">
<meta property="og:description" content="Generative Deep LearningIntroduction to Generative Adversarial Networks (GANs) (对抗生成网络)Combined by a forger network and an expert network.  Generator network Input: random vector (a random point at a">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-12-18T05:36:42.000Z">
<meta property="article:modified_time" content="2022-12-23T22:10:45.910Z">
<meta property="article:author" content="Xingchengyusi">
<meta property="article:tag" content="deep learning">
<meta property="article:tag" content="ai">
<meta property="article:tag" content="machine learning">
<meta property="article:tag" content="generative">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://localhost:4000/en/computer/generative-deep-learning.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://localhost:4000/en/computer/generative-deep-learning.html","path":"en/computer/generative-deep-learning.html","title":"Generative Deep Learning"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Generative Deep Learning | XCYS</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">XCYS</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-xuewen"><a href="/xw/" rel="section"><i class="fa fa-arrow-up-from-ground-water fa-fw"></i>XueWen</a></li><li class="menu-item menu-item-computer"><a href="/computer/" rel="section"><i class="fa fa-computer fa-fw"></i>Computer</a></li><li class="menu-item menu-item-hiking"><a href="/mountain/" rel="section"><i class="fa fa-mountain fa-fw"></i>Hiking</a></li><li class="menu-item menu-item-acgn"><a href="/acgn/" rel="section"><i class="fa fa-gamepad fa-fw"></i>ACGN</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Generative-Deep-Learning"><span class="nav-number">1.</span> <span class="nav-text">Generative Deep Learning</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction-to-Generative-Adversarial-Networks-GANs-%E5%AF%B9%E6%8A%97%E7%94%9F%E6%88%90%E7%BD%91%E7%BB%9C"><span class="nav-number">1.1.</span> <span class="nav-text">Introduction to Generative Adversarial Networks (GANs) (对抗生成网络)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Difference"><span class="nav-number">1.1.1.</span> <span class="nav-text">Difference</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Schematic-Implement"><span class="nav-number">1.1.2.</span> <span class="nav-text">Schematic Implement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tricks"><span class="nav-number">1.1.3.</span> <span class="nav-text">Tricks</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Generator"><span class="nav-number">1.1.4.</span> <span class="nav-text">The Generator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Discriminator"><span class="nav-number">1.1.5.</span> <span class="nav-text">The Discriminator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-GANs"><span class="nav-number">1.1.6.</span> <span class="nav-text">The GANs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-to-train-the-DCGAN"><span class="nav-number">1.1.7.</span> <span class="nav-text">How to train the DCGAN</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Xingchengyusi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://localhost:4000/en/computer/generative-deep-learning.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xingchengyusi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XCYS">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Generative Deep Learning | XCYS">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Generative Deep Learning
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-12-17 21:36:42" itemprop="dateCreated datePublished" datetime="2022-12-17T21:36:42-08:00">2022-12-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-23 14:10:45" itemprop="dateModified" datetime="2022-12-23T14:10:45-08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/computer/" itemprop="url" rel="index"><span itemprop="name">computer</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Generative-Deep-Learning"><a href="#Generative-Deep-Learning" class="headerlink" title="Generative Deep Learning"></a>Generative Deep Learning</h1><h2 id="Introduction-to-Generative-Adversarial-Networks-GANs-对抗生成网络"><a href="#Introduction-to-Generative-Adversarial-Networks-GANs-对抗生成网络" class="headerlink" title="Introduction to Generative Adversarial Networks (GANs) (对抗生成网络)"></a>Introduction to Generative Adversarial Networks (GANs) (对抗生成网络)</h2><p>Combined by a forger network and an expert network.</p>
<ul>
<li>Generator network<ul>
<li>Input: random vector (a random point at a latent space)</li>
<li>Output: synthetic image</li>
</ul>
</li>
<li>Discriminator Network<ul>
<li>Input: image (real or synthetic)</li>
<li>Output: predict where this image comes from.</li>
</ul>
</li>
</ul>
<span id="more"></span>

<blockquote>
<p>What is a latent space?</p>
<p>A vector space that cannot be observed.</p>
</blockquote>
<h3 id="Difference"><a href="#Difference" class="headerlink" title="Difference"></a>Difference</h3><p>The GANS different forms of other training setting up, the optimization minimum is not fixed. With the GANS, every step tries to take down the hill changes the entire landscape. There exists an equilibrium balance between two processes or forces, not a minimum optimization process.</p>
<p>Also, in this case, GANS hard to train.</p>
<h3 id="Schematic-Implement"><a href="#Schematic-Implement" class="headerlink" title="Schematic Implement"></a>Schematic Implement</h3><p>This is a <strong>deep convolutional GANS (DCGANs)</strong>.</p>
<ol>
<li><code>generator</code> maps vectors <code>(latent_dim)</code> to shape of image <code>(32, 32, 3)</code>.</li>
<li><code>discriminator</code> maps image shape <code>(32, 32, 3)</code> to a binary ‘real’ probability.</li>
<li><code>gan</code> chains the generator and discriminator together. <code>gan(x) = discriminator(generator(x))</code>.</li>
<li>train the discriminator by real and fake images and labels.</li>
<li>train the generator to fool the discriminator. Move the weight of the generator that makes discriminator classify generated image as a real image.</li>
</ol>
<h3 id="Tricks"><a href="#Tricks" class="headerlink" title="Tricks"></a>Tricks</h3><ol>
<li><code>tanh</code> as the last activation in the generator.</li>
<li>sample point the latent space using a <em>normal distribution</em>.</li>
<li>Stochasticity improves robustness. GANs may be stuck in any sort of way because of the resulting balanced equilibrium.<ol>
<li><code>dropout</code> in discriminator (and generator).</li>
<li>adding random noise to labels of the discriminator.</li>
</ol>
</li>
<li>sparse gradient hinder GANs training different from other deep learning technology. Here are two methods to decrease:<ol>
<li>change <code>maxpooling</code> to stried convolution for downsampling.</li>
<li>change <code>ReLu</code> to <code>LeakyReLu</code> which relax sparsity constants by allowing small negative activation value.</li>
</ol>
</li>
<li>To fix the checkerboard artifact caused by unequal coverage of the pixel space in the generator, the stridden <code>Conv2DTranpose</code> or <code>Conv2D</code> in both generator and discriminator.</li>
<li>When adversarial loss increases and discriminative loss tends to 0 (discriminator end up dominating the generator), reduce the discriminator learning rate, and increase the dropout level of the discriminator.</li>
</ol>
<h3 id="The-Generator"><a href="#The-Generator" class="headerlink" title="The Generator"></a>The Generator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import</span></span><br><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> kerasimport layers</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># input shape</span></span><br><span class="line">latent_dim = <span class="number">32</span></span><br><span class="line">height = <span class="number">32</span></span><br><span class="line">width = <span class="number">32</span></span><br><span class="line">channels = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># module</span></span><br><span class="line">generator_input = keras.Input(shape=(latent_dim, ))</span><br><span class="line"><span class="comment"># transform the input into a 16*16 128 channel feature map</span></span><br><span class="line">x = layers.Dense(<span class="number">128</span> * <span class="number">16</span> * <span class="number">16</span>)(generator_input)</span><br><span class="line">x = layers.LeakyReLu()(x)</span><br><span class="line">x = layers.Reshape((<span class="number">16</span> * <span class="number">16</span> * <span class="number">128</span>)) (x)</span><br><span class="line"></span><br><span class="line">x = layers.Conv2D(<span class="number">256</span>, <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">x = layers.LeakyReLu()(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># upsamples to 32*32</span></span><br><span class="line">x = layers.Conv2DTranspose(<span class="number">256</span>, <span class="number">4</span>, strides=<span class="number">2</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">x = layers.LeakyReLu()(x)</span><br><span class="line"></span><br><span class="line">x = layers.Conv2D(<span class="number">256</span>, <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">x = layers.LeakyReLu()(x)</span><br><span class="line">x = layers.Conv2D(<span class="number">256</span>, <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">x = layers.LeakyReLu()(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># produces 32*32 1 channel feature map</span></span><br><span class="line">x = layers.Conv2D(channels, <span class="number">7</span>, activation=<span class="string">&#x27;tanh&#x27;</span>, padding=<span class="string">&#x27;same&#x27;</span>)(x)</span><br><span class="line">generator = keras.models.Model(generator_input, x)</span><br><span class="line">generator.summary()</span><br></pre></td></tr></table></figure>

<h3 id="The-Discriminator"><a href="#The-Discriminator" class="headerlink" title="The Discriminator"></a>The Discriminator</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">discriminator_input = layers.Input(shape=(height, width, channels))</span><br><span class="line">x = layers.Conv2D(<span class="number">128</span>, <span class="number">3</span>)(discriminator_input)</span><br><span class="line">x = layers.LeakyReLU()(x)</span><br><span class="line">x = layers.Conv2D(<span class="number">128</span>, <span class="number">4</span>, strides=<span class="number">2</span>)(x)</span><br><span class="line">x = layers.LeakyReLU()(x)</span><br><span class="line">x = layers.Conv2D(<span class="number">128</span>, <span class="number">4</span>, strides=<span class="number">2</span>)(x)</span><br><span class="line">x = layers.LeakyReLU()(x)</span><br><span class="line">x = layers.Conv2D(<span class="number">128</span>, <span class="number">4</span>, strides=<span class="number">2</span>)(x)</span><br><span class="line">x = layers.LeakyReLU()(x)</span><br><span class="line">x = layers.Flatten()(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># dropout layer</span></span><br><span class="line">x = layers.Dropout(<span class="number">0.4</span>)(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># output layer</span></span><br><span class="line">x = layers.Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>)(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># instantiates module</span></span><br><span class="line">discriminator = keras.models.Model(discriminator_input, x)</span><br><span class="line">discriminator.summary()</span><br><span class="line"></span><br><span class="line"><span class="comment"># using gradient clipping by value in the optimizer / to stabilize, use learning rate decay</span></span><br><span class="line">discriminator_optimizer = keras.optimizers.RMSprop(lr=<span class="number">0.0008</span>, clipvalue=<span class="number">1.0</span>, decay=<span class="number">1e-8</span>)</span><br><span class="line">discriminator.<span class="built_in">compile</span>(optimizer=discriminator_optimizer, loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="The-GANs"><a href="#The-GANs" class="headerlink" title="The GANs"></a>The GANs</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># only applies to gan model</span></span><br><span class="line">discriminator.trainable = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">gan_input = keras.Input(shape=(latent_dim, ))</span><br><span class="line">gan_output = discriminator(generator(gan_input))</span><br><span class="line">gan = keras.models.Model(gan_input, gan_output)</span><br><span class="line"></span><br><span class="line">gan_optimizer = keras.optimizers.RMSprop(lr=<span class="number">0.0004</span>, clipvalue=<span class="number">1.0</span>, decay=<span class="number">1e-8</span>)</span><br><span class="line">gan.<span class="built_in">compile</span>(optimizer=gan_optimizer, loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="How-to-train-the-DCGAN"><a href="#How-to-train-the-DCGAN" class="headerlink" title="How to train the DCGAN"></a>How to train the DCGAN</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> keras.preprocessing <span class="keyword">import</span> image</span><br><span class="line"></span><br><span class="line"><span class="comment"># laod cifar-10</span></span><br><span class="line">(x_train, y_train), (_, _) = keras.datasets.cifar10.load_data()</span><br><span class="line"></span><br><span class="line">x_train = x_train.reshape(</span><br><span class="line">  (x_train.shape[<span class="number">0</span>],) +</span><br><span class="line">  (height, width, channels)).astype(<span class="string">&#x27;float32&#x27;</span>) / <span class="number">255.</span></span><br><span class="line"></span><br><span class="line">iterations = <span class="number">10000</span></span><br><span class="line">batch_size = <span class="number">20</span></span><br><span class="line">save_dir = <span class="string">&#x27;your_dir&#x27;</span></span><br><span class="line"></span><br><span class="line">start = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> step <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">  random_latent_vectors = np.random.normal(size=(batch_size, latent_dim))</span><br><span class="line"></span><br><span class="line">generated_images = generator.predict(random_latent_vectors)</span><br><span class="line"></span><br><span class="line">stop = start + batch_size</span><br><span class="line">real_images = x_train[start: stop]</span><br><span class="line">combined_images = np.concatenate([generated_images, real_images])</span><br><span class="line"></span><br><span class="line">labels = np.concatenate([np.ones((batch_size, <span class="number">1</span>)), np.zeros((batch_size, <span class="number">1</span>))])</span><br><span class="line">labels += <span class="number">0.05</span> * np.random.random(labels.shape)</span><br><span class="line"></span><br><span class="line">d_loss = discriminator.train_on_batch(combined_images, labels)</span><br><span class="line"></span><br><span class="line">random_latent_vectors = np.random.normal(size=(batch_size, latent_dim))</span><br><span class="line"></span><br><span class="line">misleading_targets = np.zeros((batch_size, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">a_loss = gan.train_on_batch(random_latent_vectors, misleading_targets)</span><br><span class="line"></span><br><span class="line">start += batch_size</span><br><span class="line"><span class="keyword">if</span> start &gt; <span class="built_in">len</span>(x_train) - batch_size:</span><br><span class="line">  start = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> step % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">  gan.save_weights(<span class="string">&#x27;gan.h5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;discriminator loss:&#x27;</span>, d_loss)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;adversarial loss:&#x27;</span>, a_loss)</span><br><span class="line"></span><br><span class="line">  img = image.array_to_img(generated_images[<span class="number">0</span>] * <span class="number">255.</span>, scale=<span class="literal">False</span>)</span><br><span class="line">  img.save(os.path.join(save_dir, <span class="string">&#x27;generated_frog&#x27;</span> + <span class="built_in">str</span>(step) + <span class="string">&#x27;.png&#x27;</span>))</span><br><span class="line">  img = image.array_to_img(real_images[<span class="number">0</span>] * <span class="number">255.</span>, scale=<span class="literal">False</span>)</span><br><span class="line">  img.save(os.path.join(save_dir, <span class="string">&#x27;real_frog&#x27;</span> + <span class="built_in">str</span>(step) + <span class="string">&#x27;.png&#x27;</span>))</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/deep-learning/" rel="tag"># deep learning</a>
              <a href="/tags/ai/" rel="tag"># ai</a>
              <a href="/tags/machine-learning/" rel="tag"># machine learning</a>
              <a href="/tags/generative/" rel="tag"># generative</a>
              <a href="/tags/python/" rel="tag"># python</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/en/computer/some-useful-functions-in-sql.html" rel="prev" title="Some Useful Functions in SQL">
                  <i class="fa fa-chevron-left"></i> Some Useful Functions in SQL
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/en/computer/import-in-python.html" rel="next" title="Import in Python">
                  Import in Python <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xingchengyusi</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/xingchengyusi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
